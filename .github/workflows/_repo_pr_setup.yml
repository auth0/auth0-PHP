name: Contributors

on:
  pull_request_target:
    types:
      - opened

permissions:
  issues: write
  pull-requests: write

jobs:
  setup_labels:
    name: Setup Labels
    runs-on: ubuntu-latest

    steps:
      - uses: actions/github-script@v6
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: '**ğŸ‘‹ Thanks for contributing!** Please be patient while a maintainer reviews your PR. In the meantime, please make sure you've read our [contributing guide](CONTRIBUTING.md).'
            })

            const pattern = /^(\w*)(?:\(([\w$.\-*/ ]*)\))?: (.*)$/g
            const title = github.event.pull_request.title
            const [type, scope, subject] = title.match(pattern)

            if (type === "feat" || type === "refactor" || type === "perf") {
              github.rest.pulls.addLabel({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: ["Type: â­ Enhancement"]
              })
            }

            if (type === "build" || type === "ci" || type === "style") {
              github.rest.pulls.addLabel({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: ["Type: ğŸ”§ Maintenance"]
              })
            }

            if (type === "fix") {
              github.rest.pulls.addLabel({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: ["Type: ğŸ Bug"]
              })
            }

            if (type === "security") {
              github.rest.pulls.addLabel({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: ["Type: ğŸš¨ Security"]
              })
            }

            if (type === "docs") {
              github.rest.pulls.addLabel({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: ["Type: ğŸ“– Documentation"]
              })
            }

            if (type === "test") {
              github.rest.pulls.addLabel({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: ["Type: ğŸ§ª Tests"]
              })
            }
